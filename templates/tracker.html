{% extends "base.html" %}
{% block content %}
<div class="header">
    <h1 class="page-title">Трекер та Інструменти</h1>
</div>

{% with messages = get_flashed_messages(with_categories=True) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="card flash-message {{ category }}">
                <i class="fas {% if category=='error' %}fa-exclamation-circle{% else %}fa-check-circle{% endif %}"></i>
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
{% endwith %}

<h2 style="margin-bottom: 20px; color: var(--dark); border-bottom: 2px solid #e3e6f0; padding-bottom: 10px;">Внесення показників</h2>

<div class="grid-container" style="margin-bottom: 40px;">
    <div class="card">
        <h3><i class="fas fa-heartbeat" style="color: #e74a3b;"></i> Дані здоров'я</h3>
        <form method="POST" action="/tracker">
            <input type="hidden" name="form_type" value="health_data">
            
            <div class="form-group">
                <label>Дата</label>
                <input type="date" name="date" required class="form-control">
            </div>
            <div class="form-group">
                <label>Пульс (уд/хв)</label>
                <input type="number" name="pulse" class="form-control" placeholder="60">
            </div>
            <div class="form-group">
                <label>Тиск (120/80)</label>
                <input type="text" name="blood_pressure" class="form-control" placeholder="120/80">
            </div>
            <div class="form-group">
                <label>Сон (годин)</label>
                <input type="number" step="0.1" name="duration_sleep" class="form-control" placeholder="8.0">
            </div>
            <button type="submit" class="btn-primary">Зберегти показники</button>
        </form>
    </div>

    <div class="card">
        <h3><i class="fas fa-weight"></i> Вага та виміри</h3>
        <form method="POST" action="/tracker">
            <input type="hidden" name="form_type" value="basic_data">
            
            <div class="form-group">
                <label>Дата</label>
                <input type="date" name="date" required class="form-control">
            </div>
            
            <div class="form-group">
                <label>Вага (кг)</label>
                <input type="number" step="0.1" name="weight" class="form-control" placeholder="70.5" required>
            </div>

            <div class="form-group">
                <label>Зріст (см)</label>
                <input type="number" name="height" class="form-control" placeholder="175" required>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <div class="form-group">
                    <label>Вік</label>
                    <input type="number" name="age" class="form-control" placeholder="25">
                </div>
                <div class="form-group">
                    <label>Стать</label>
                    <select name="gender" class="form-control">
                        <option value="male">Чол.</option>
                        <option value="female">Жін.</option>
                    </select>
                </div>
            </div>

            <button type="submit" class="btn-primary">Зберегти вагу</button>
        </form>

    </div>
    <div class="card">
        <h3><i class="fas fa-running" style="color: #1cc88a;"></i> Активність</h3>
        <form method="POST" action="/tracker">
            <input type="hidden" name="form_type" value="activity_data">
            
            <div class="form-group">
                <label>Дата</label>
                <input type="date" name="date" required class="form-control">
            </div>
            <div class="form-group">
                <label>Тип активності</label>
                <select name="activity_type" class="form-control">
                    <option value="walking">Ходьба</option>
                    <option value="running">Біг</option>
                    <option value="gym">Зал</option>
                    <option value="cycling">Велосипед</option>
                </select>
            </div>
            <div class="form-group">
                <label>Тривалість (хв)</label>
                <input type="number" name="duration" class="form-control" placeholder="30">
            </div>
            <div class="form-group">
                <label>Вода (літрів)</label>
                <input type="number" step="0.1" name="water_intake" class="form-control" placeholder="1.5">
            </div>
            <button type="submit" class="btn-primary">Зберегти активність</button>
        </form>
    </div>
</div>

<h2 style="margin-bottom: 20px; color: var(--dark); border-bottom: 2px solid #e3e6f0; padding-bottom: 10px;">
    <i class="fas fa-calculator"></i> Калькулятори здоров'я
</h2>

<div class="grid-container">
    
    <div class="card">
        <h3>Калькулятор ІМТ</h3>
        <form action="/tracker" method="POST">
            <input type="hidden" name="form_type" value="calculator">
            <input type="hidden" name="calculator_type" value="bmi">
            
            <div class="form-group">
                <label for="weight">Вага (кг):</label>
                <input type="number" class="form-control" name="weight" id="weight" step="0.1" required>
            </div>
            <div class="form-group">
                <label for="height">Зріст (см):</label>
                <input type="number" class="form-control" name="height" id="height" step="0.1" required>
            </div>
            <button type="submit" class="btn-primary">Розрахувати ІМТ</button>
        </form>
        
        {% if bmi_result is not none %}
            <div class="result-box">
                <i class="fas fa-check-circle"></i> Ваш ІМТ: {{ bmi_result }}
            </div>
        {% endif %}
    </div>

    <div class="card">
        <h3>Відсоток жиру</h3>
        <form action="/tracker" method="POST">
            <input type="hidden" name="form_type" value="calculator">
            <input type="hidden" name="calculator_type" value="body_fat">
            
            <div class="form-group">
                <label for="gender">Стать:</label>
                <select name="gender" id="gender" class="form-control" required>
                    <option value="male">Чоловік</option>
                    <option value="female">Жінка</option>
                </select>
            </div>
            <div class="form-group">
                <label for="age">Вік:</label>
                <input type="number" name="age" id="age" class="form-control" required>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div class="form-group">
                    <label>Груди (см):</label>
                    <input type="number" name="chest" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>Живіт (см):</label>
                    <input type="number" name="abdomen" class="form-control" required>
                </div>
            </div>
            <div class="form-group">
                <label for="thigh">Стегно (см):</label>
                <input type="number" name="thigh" id="thigh" class="form-control" required>
            </div>
            <button type="submit" class="btn-primary">Розрахувати жир</button>
        </form>
        
        {% if fat_result is not none %}
            <div style="margin-top: 15px; padding: 10px; background: #e8f5e9; border-radius: 8px; color: #1b5e20; font-weight: bold; text-align: center;">
                Ваш відсоток жиру: {{ fat_result }}%
            </div>
        {% endif %}
    </div>

    <div class="card">
        <h3>Калькулятор калорій</h3>
        <form action="/tracker" method="POST">
            <input type="hidden" name="form_type" value="calculator">
            <input type="hidden" name="calculator_type" value="calories">
            
            <div class="form-group">
                <label for="gender-cal">Стать:</label>
                <select name="gender" id="gender-cal" class="form-control" required>
                    <option value="male">Чоловік</option>
                    <option value="female">Жінка</option>
                </select>
            </div>
            <div class="form-group">
                <label for="weight-cal">Вага (кг):</label>
                <input type="number" name="weight" id="weight-cal" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="height-cal">Зріст (см):</label>
                <input type="number" name="height" id="height-cal" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="age-cal">Вік:</label>
                <input type="number" name="age" id="age-cal" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="activity-level">Активність:</label>
                <select name="activity_level" id="activity-level" class="form-control" required>
                    <option value="1.2">Мінімальна</option>
                    <option value="1.375">Легка</option>
                    <option value="1.55">Помірна</option>
                    <option value="1.725">Висока</option>
                    <option value="1.9">Екстремальна</option>
                </select>
            </div>
            <button type="submit" class="btn-primary">Розрахувати калорії</button>
        </form>
        
        {% if calorie_result is not none %}
            <div style="margin-top: 15px; padding: 10px; background: #e8f5e9; border-radius: 8px; color: #1b5e20; font-weight: bold; text-align: center;">
                Норма калорій: {{ calorie_result }} ккал
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}